{"ast":null,"code":"/**\n * Register event listener on document that fires when:\n * * tab change or tab close (in mobile or desktop)\n * * click back / forward button\n * * click any link or perform any other navigation action\n * * soft refresh / hard refresh\n *\n * adapted from https://stackoverflow.com/questions/3239834/window-onbeforeunload-not-working-on-the-ipad/52864508#52864508,\n */\nexport var onPageChange = function (cb) {\n  var unloaded = false; // prevents double firing if both are supported\n  window.addEventListener('pagehide', function () {\n    if (unloaded) return;\n    unloaded = true;\n    cb(unloaded);\n  });\n  // using document instead of window because of bug affecting browsers before safari 14 (detail in footnotes https://caniuse.com/?search=visibilitychange)\n  document.addEventListener('visibilitychange', function () {\n    if (document.visibilityState == 'hidden') {\n      if (unloaded) return;\n      unloaded = true;\n    } else {\n      unloaded = false;\n    }\n    cb(unloaded);\n  });\n};","map":{"version":3,"names":["onPageChange","cb","unloaded","window","addEventListener","document","visibilityState"],"sources":["/Users/bcaudillo/Desktop/Projects/todo/node_modules/@segment/analytics-next/src/lib/on-page-change.ts"],"sourcesContent":["/**\n * Register event listener on document that fires when:\n * * tab change or tab close (in mobile or desktop)\n * * click back / forward button\n * * click any link or perform any other navigation action\n * * soft refresh / hard refresh\n *\n * adapted from https://stackoverflow.com/questions/3239834/window-onbeforeunload-not-working-on-the-ipad/52864508#52864508,\n */\nexport const onPageChange = (cb: (unloaded: boolean) => void) => {\n  let unloaded = false // prevents double firing if both are supported\n\n  window.addEventListener('pagehide', () => {\n    if (unloaded) return\n    unloaded = true\n    cb(unloaded)\n  })\n\n  // using document instead of window because of bug affecting browsers before safari 14 (detail in footnotes https://caniuse.com/?search=visibilitychange)\n  document.addEventListener('visibilitychange', () => {\n    if (document.visibilityState == 'hidden') {\n      if (unloaded) return\n      unloaded = true\n    } else {\n      unloaded = false\n    }\n    cb(unloaded)\n  })\n}\n"],"mappings":"AAAA;;;;;;;;;AASA,OAAO,IAAMA,YAAY,GAAG,SAAAA,CAACC,EAA+B;EAC1D,IAAIC,QAAQ,GAAG,KAAK,EAAC;EAErBC,MAAM,CAACC,gBAAgB,CAAC,UAAU,EAAE;IAClC,IAAIF,QAAQ,EAAE;IACdA,QAAQ,GAAG,IAAI;IACfD,EAAE,CAACC,QAAQ,CAAC;EACd,CAAC,CAAC;EAEF;EACAG,QAAQ,CAACD,gBAAgB,CAAC,kBAAkB,EAAE;IAC5C,IAAIC,QAAQ,CAACC,eAAe,IAAI,QAAQ,EAAE;MACxC,IAAIJ,QAAQ,EAAE;MACdA,QAAQ,GAAG,IAAI;KAChB,MAAM;MACLA,QAAQ,GAAG,KAAK;;IAElBD,EAAE,CAACC,QAAQ,CAAC;EACd,CAAC,CAAC;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}