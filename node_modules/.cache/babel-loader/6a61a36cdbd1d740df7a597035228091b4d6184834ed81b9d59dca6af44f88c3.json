{"ast":null,"code":"import { pTimeout } from './callback';\n// Check if a user is opening the link in a new tab\nfunction userNewTab(event) {\n  var typedEvent = event;\n  if (typedEvent.ctrlKey || typedEvent.shiftKey || typedEvent.metaKey || typedEvent.button && typedEvent.button == 1) {\n    return true;\n  }\n  return false;\n}\n// Check if the link opens in new tab\nfunction linkNewTab(element, href) {\n  if (element.target === '_blank' && href) {\n    return true;\n  }\n  return false;\n}\nexport function link(links, event, properties, options) {\n  var _this = this;\n  var elements = [];\n  // always arrays, handles jquery\n  if (!links) {\n    return this;\n  }\n  if (links instanceof Element) {\n    elements = [links];\n  } else if ('toArray' in links) {\n    elements = links.toArray();\n  } else {\n    elements = links;\n  }\n  elements.forEach(function (el) {\n    el.addEventListener('click', function (elementEvent) {\n      var _a, _b;\n      var ev = event instanceof Function ? event(el) : event;\n      var props = properties instanceof Function ? properties(el) : properties;\n      var href = el.getAttribute('href') || el.getAttributeNS('http://www.w3.org/1999/xlink', 'href') || el.getAttribute('xlink:href') || ((_a = el.getElementsByTagName('a')[0]) === null || _a === void 0 ? void 0 : _a.getAttribute('href'));\n      var trackEvent = pTimeout(_this.track(ev, props, options !== null && options !== void 0 ? options : {}), (_b = _this.settings.timeout) !== null && _b !== void 0 ? _b : 500);\n      if (!linkNewTab(el, href) && !userNewTab(elementEvent)) {\n        if (href) {\n          elementEvent.preventDefault ? elementEvent.preventDefault() : elementEvent.returnValue = false;\n          trackEvent.catch(console.error).then(function () {\n            window.location.href = href;\n          }).catch(console.error);\n        }\n      }\n    }, false);\n  });\n  return this;\n}\nexport function form(forms, event, properties, options) {\n  var _this = this;\n  // always arrays, handles jquery\n  if (!forms) return this;\n  if (forms instanceof HTMLFormElement) forms = [forms];\n  var elements = forms;\n  elements.forEach(function (el) {\n    if (!(el instanceof Element)) throw new TypeError('Must pass HTMLElement to trackForm/trackSubmit.');\n    var handler = function (elementEvent) {\n      var _a;\n      elementEvent.preventDefault ? elementEvent.preventDefault() : elementEvent.returnValue = false;\n      var ev = event instanceof Function ? event(el) : event;\n      var props = properties instanceof Function ? properties(el) : properties;\n      var trackEvent = pTimeout(_this.track(ev, props, options !== null && options !== void 0 ? options : {}), (_a = _this.settings.timeout) !== null && _a !== void 0 ? _a : 500);\n      trackEvent.catch(console.error).then(function () {\n        el.submit();\n      }).catch(console.error);\n    };\n    // Support the events happening through jQuery or Zepto instead of through\n    // the normal DOM API, because `el.submit` doesn't bubble up events...\n    var $ = window.jQuery || window.Zepto;\n    if ($) {\n      $(el).submit(handler);\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-misused-promises\n      el.addEventListener('submit', handler, false);\n    }\n  });\n  return this;\n}","map":{"version":3,"names":["pTimeout","userNewTab","event","typedEvent","ctrlKey","shiftKey","metaKey","button","linkNewTab","element","href","target","link","links","properties","options","_this","elements","Element","toArray","forEach","el","addEventListener","elementEvent","ev","Function","props","getAttribute","getAttributeNS","_a","getElementsByTagName","trackEvent","track","_b","settings","timeout","preventDefault","returnValue","catch","console","error","then","window","location","form","forms","HTMLFormElement","TypeError","handler","submit","$","jQuery","Zepto"],"sources":["/Users/bcaudillo/Desktop/Projects/todo/node_modules/@segment/analytics-next/src/core/auto-track.ts"],"sourcesContent":["import { Analytics } from './analytics'\nimport { EventProperties, Options } from './events'\nimport { pTimeout } from './callback'\n\n// Check if a user is opening the link in a new tab\nfunction userNewTab(event: Event): boolean {\n  const typedEvent = event as Event & {\n    ctrlKey: boolean\n    shiftKey: boolean\n    metaKey: boolean\n    button: number\n  }\n  if (\n    typedEvent.ctrlKey ||\n    typedEvent.shiftKey ||\n    typedEvent.metaKey ||\n    (typedEvent.button && typedEvent.button == 1)\n  ) {\n    return true\n  }\n  return false\n}\n\n// Check if the link opens in new tab\nfunction linkNewTab(element: HTMLAnchorElement, href: string | null): boolean {\n  if (element.target === '_blank' && href) {\n    return true\n  }\n  return false\n}\n\nexport interface JQueryShim<TElement = HTMLElement> {\n  toArray(): TElement[]\n}\n\nexport function link(\n  this: Analytics,\n  links: Element | Array<Element> | JQueryShim | null,\n  event: string | Function,\n  properties?: EventProperties | Function,\n  options?: Options\n): Analytics {\n  let elements: Array<Element> = []\n  // always arrays, handles jquery\n  if (!links) {\n    return this\n  }\n  if (links instanceof Element) {\n    elements = [links]\n  } else if ('toArray' in links) {\n    elements = links.toArray()\n  } else {\n    elements = links\n  }\n\n  elements.forEach((el: Element) => {\n    el.addEventListener(\n      'click',\n      (elementEvent: Event) => {\n        const ev = event instanceof Function ? event(el) : event\n        const props =\n          properties instanceof Function ? properties(el) : properties\n        const href =\n          el.getAttribute('href') ||\n          el.getAttributeNS('http://www.w3.org/1999/xlink', 'href') ||\n          el.getAttribute('xlink:href') ||\n          el.getElementsByTagName('a')[0]?.getAttribute('href')\n\n        const trackEvent = pTimeout(\n          this.track(ev, props, options ?? {}),\n          this.settings.timeout ?? 500\n        )\n\n        if (\n          !linkNewTab(el as HTMLAnchorElement, href) &&\n          !userNewTab(elementEvent)\n        ) {\n          if (href) {\n            elementEvent.preventDefault\n              ? elementEvent.preventDefault()\n              : (elementEvent.returnValue = false)\n            trackEvent\n              .catch(console.error)\n              .then(() => {\n                window.location.href = href\n              })\n              .catch(console.error)\n          }\n        }\n      },\n      false\n    )\n  })\n\n  return this\n}\n\nexport type LinkArgs = Parameters<typeof link>\n\nexport function form(\n  this: Analytics,\n  forms: HTMLFormElement | Array<HTMLFormElement> | null,\n  event: string | Function,\n  properties?: EventProperties | Function,\n  options?: Options\n): Analytics {\n  // always arrays, handles jquery\n  if (!forms) return this\n  if (forms instanceof HTMLFormElement) forms = [forms]\n\n  const elements = forms\n\n  elements.forEach((el) => {\n    if (!(el instanceof Element))\n      throw new TypeError('Must pass HTMLElement to trackForm/trackSubmit.')\n    const handler = (elementEvent: Event): void => {\n      elementEvent.preventDefault\n        ? elementEvent.preventDefault()\n        : (elementEvent.returnValue = false)\n\n      const ev = event instanceof Function ? event(el) : event\n      const props = properties instanceof Function ? properties(el) : properties\n\n      const trackEvent = pTimeout(\n        this.track(ev, props, options ?? {}),\n        this.settings.timeout ?? 500\n      )\n\n      trackEvent\n        .catch(console.error)\n        .then(() => {\n          el.submit()\n        })\n        .catch(console.error)\n    }\n\n    // Support the events happening through jQuery or Zepto instead of through\n    // the normal DOM API, because `el.submit` doesn't bubble up events...\n\n    const $ = (window as any).jQuery || (window as any).Zepto\n    if ($) {\n      $(el).submit(handler)\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-misused-promises\n      el.addEventListener('submit', handler, false)\n    }\n  })\n\n  return this\n}\n\nexport type FormArgs = Parameters<typeof form>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}