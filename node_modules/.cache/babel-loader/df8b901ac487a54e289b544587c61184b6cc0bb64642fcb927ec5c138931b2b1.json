{"ast":null,"code":"import cookie from 'js-cookie';\n/**\n * Levels returns all levels of the given url.\n *\n * @param {string} url\n * @return {Array}\n * @api public\n */\nfunction levels(url) {\n  var host = url.hostname;\n  var parts = host.split('.');\n  var last = parts[parts.length - 1];\n  var levels = [];\n  // Ip address.\n  if (parts.length === 4 && parseInt(last, 10) > 0) {\n    return levels;\n  }\n  // Localhost.\n  if (parts.length <= 1) {\n    return levels;\n  }\n  // Create levels.\n  for (var i = parts.length - 2; i >= 0; --i) {\n    levels.push(parts.slice(i).join('.'));\n  }\n  return levels;\n}\nfunction parseUrl(url) {\n  try {\n    return new URL(url);\n  } catch (_a) {\n    return;\n  }\n}\nexport function tld(url) {\n  var parsedUrl = parseUrl(url);\n  if (!parsedUrl) return;\n  var lvls = levels(parsedUrl);\n  // Lookup the real top level one.\n  for (var i = 0; i < lvls.length; ++i) {\n    var cname = '__tld__';\n    var domain = lvls[i];\n    var opts = {\n      domain: '.' + domain\n    };\n    try {\n      // cookie access throw an error if the library is ran inside a sandboxed environment (e.g. sandboxed iframe)\n      cookie.set(cname, '1', opts);\n      if (cookie.get(cname)) {\n        cookie.remove(cname, opts);\n        return domain;\n      }\n    } catch (_) {\n      return;\n    }\n  }\n}","map":{"version":3,"names":["cookie","levels","url","host","hostname","parts","split","last","length","parseInt","i","push","slice","join","parseUrl","URL","_a","tld","parsedUrl","lvls","cname","domain","opts","set","get","remove","_"],"sources":["/Users/bcaudillo/Desktop/Projects/todo/node_modules/@segment/analytics-next/src/core/user/tld.ts"],"sourcesContent":["import cookie from 'js-cookie'\n\n/**\n * Levels returns all levels of the given url.\n *\n * @param {string} url\n * @return {Array}\n * @api public\n */\nfunction levels(url: URL): string[] {\n  const host = url.hostname\n  const parts = host.split('.')\n  const last = parts[parts.length - 1]\n  const levels: string[] = []\n\n  // Ip address.\n  if (parts.length === 4 && parseInt(last, 10) > 0) {\n    return levels\n  }\n\n  // Localhost.\n  if (parts.length <= 1) {\n    return levels\n  }\n\n  // Create levels.\n  for (let i = parts.length - 2; i >= 0; --i) {\n    levels.push(parts.slice(i).join('.'))\n  }\n\n  return levels\n}\n\nfunction parseUrl(url: string): URL | undefined {\n  try {\n    return new URL(url)\n  } catch {\n    return\n  }\n}\n\nexport function tld(url: string): string | undefined {\n  const parsedUrl = parseUrl(url)\n  if (!parsedUrl) return\n\n  const lvls = levels(parsedUrl)\n\n  // Lookup the real top level one.\n  for (let i = 0; i < lvls.length; ++i) {\n    const cname = '__tld__'\n    const domain = lvls[i]\n    const opts = { domain: '.' + domain }\n\n    try {\n      // cookie access throw an error if the library is ran inside a sandboxed environment (e.g. sandboxed iframe)\n      cookie.set(cname, '1', opts)\n      if (cookie.get(cname)) {\n        cookie.remove(cname, opts)\n        return domain\n      }\n    } catch (_) {\n      return\n    }\n  }\n}\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,WAAW;AAE9B;;;;;;;AAOA,SAASC,MAAMA,CAACC,GAAQ;EACtB,IAAMC,IAAI,GAAGD,GAAG,CAACE,QAAQ;EACzB,IAAMC,KAAK,GAAGF,IAAI,CAACG,KAAK,CAAC,GAAG,CAAC;EAC7B,IAAMC,IAAI,GAAGF,KAAK,CAACA,KAAK,CAACG,MAAM,GAAG,CAAC,CAAC;EACpC,IAAMP,MAAM,GAAa,EAAE;EAE3B;EACA,IAAII,KAAK,CAACG,MAAM,KAAK,CAAC,IAAIC,QAAQ,CAACF,IAAI,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE;IAChD,OAAON,MAAM;;EAGf;EACA,IAAII,KAAK,CAACG,MAAM,IAAI,CAAC,EAAE;IACrB,OAAOP,MAAM;;EAGf;EACA,KAAK,IAAIS,CAAC,GAAGL,KAAK,CAACG,MAAM,GAAG,CAAC,EAAEE,CAAC,IAAI,CAAC,EAAE,EAAEA,CAAC,EAAE;IAC1CT,MAAM,CAACU,IAAI,CAACN,KAAK,CAACO,KAAK,CAACF,CAAC,CAAC,CAACG,IAAI,CAAC,GAAG,CAAC,CAAC;;EAGvC,OAAOZ,MAAM;AACf;AAEA,SAASa,QAAQA,CAACZ,GAAW;EAC3B,IAAI;IACF,OAAO,IAAIa,GAAG,CAACb,GAAG,CAAC;GACpB,CAAC,OAAAc,EAAA,EAAM;IACN;;AAEJ;AAEA,OAAM,SAAUC,GAAGA,CAACf,GAAW;EAC7B,IAAMgB,SAAS,GAAGJ,QAAQ,CAACZ,GAAG,CAAC;EAC/B,IAAI,CAACgB,SAAS,EAAE;EAEhB,IAAMC,IAAI,GAAGlB,MAAM,CAACiB,SAAS,CAAC;EAE9B;EACA,KAAK,IAAIR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGS,IAAI,CAACX,MAAM,EAAE,EAAEE,CAAC,EAAE;IACpC,IAAMU,KAAK,GAAG,SAAS;IACvB,IAAMC,MAAM,GAAGF,IAAI,CAACT,CAAC,CAAC;IACtB,IAAMY,IAAI,GAAG;MAAED,MAAM,EAAE,GAAG,GAAGA;IAAM,CAAE;IAErC,IAAI;MACF;MACArB,MAAM,CAACuB,GAAG,CAACH,KAAK,EAAE,GAAG,EAAEE,IAAI,CAAC;MAC5B,IAAItB,MAAM,CAACwB,GAAG,CAACJ,KAAK,CAAC,EAAE;QACrBpB,MAAM,CAACyB,MAAM,CAACL,KAAK,EAAEE,IAAI,CAAC;QAC1B,OAAOD,MAAM;;KAEhB,CAAC,OAAOK,CAAC,EAAE;MACV;;;AAGN","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}